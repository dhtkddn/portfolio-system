# ğŸš€ MIRAE-PORTFOLIO SYSTEM

**AI ê¸°ë°˜ í•œêµ­ ì£¼ì‹ ë§ì¶¤ í¬íŠ¸í´ë¦¬ì˜¤ ì¶”ì²œ ì‹œìŠ¤í…œ**

> HyperCLOVA Xì™€ PostgreSQLì„ í™œìš©í•œ ì§€ëŠ¥í˜• íˆ¬ì ìë¬¸ í”Œë«í¼

**MIRAE-PORTFOLIO**ëŠ” í•œêµ­ ì£¼ì‹ì‹œì¥(KOSPI/KOSDAQ)ì˜ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì¸ ë§ì¶¤í˜• í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì¶”ì²œí•˜ëŠ” AI ê¸°ë°˜ íˆ¬ì ìë¬¸ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### ğŸŒŸ í•µì‹¬ ê°€ì¹˜

* **ğŸ¯ ê°œì¸í™”**: íˆ¬ììì˜ ë‚˜ì´, ê²½í—˜, ìœ„í—˜ì„±í–¥ì— ë§ì¶¤í˜• í¬íŠ¸í´ë¦¬ì˜¤ ì œê³µ
* **ğŸ§  AI ë¶„ì„**: HyperCLOVA Xë¥¼ í™œìš©í•œ ì§€ëŠ¥í˜• ì¬ë¬´ë¶„ì„ ë° íˆ¬ì ì„¤ëª…
* **ğŸ“Š ì‹¤ì‹œê°„ ë°ì´í„°**: PyKRX, Yahoo Financeë¥¼ í†µí•œ ìµœì‹  ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘
* **ğŸ” í¬ê´„ì  ë¶„ì„**: ê¸°ìˆ ì  ë¶„ì„ë¶€í„° ì¬ë¬´ì œí‘œ ë¹„êµê¹Œì§€ ì›ìŠ¤í†± ì„œë¹„ìŠ¤

### ğŸ¯ ëŒ€ìƒ ì‚¬ìš©ì

* ğŸ“ˆ **ê°œì¸ íˆ¬ìì**: ì²´ê³„ì ì¸ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±ì„ ì›í•˜ëŠ” íˆ¬ìì
* ğŸ’¼ **ê¸ˆìœµ ìë¬¸ì‚¬**: ê³ ê° ìƒë‹´ìš© ë„êµ¬ë¡œ í™œìš©
* ğŸ“ **íˆ¬ì í•™ìŠµì**: íˆ¬ì ì›ë¦¬ì™€ í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¡  í•™ìŠµ
* ğŸ¢ **í•€í…Œí¬ ê¸°ì—…**: íˆ¬ì ì„œë¹„ìŠ¤ ê°œë°œì„ ìœ„í•œ ê¸°ë°˜ ì‹œìŠ¤í…œ

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ğŸ¤– AI ê¸°ë°˜ ëŒ€í™”í˜• íˆ¬ì ìƒë‹´

ì‚¬ìš©ìì˜ ìì—°ì–´ ì§ˆë¬¸ì„ ì´í•´í•˜ê³ , íˆ¬ì ì„±í–¥ì„ íŒŒì•…í•˜ì—¬ ë§ì¶¤í˜• íˆ¬ì í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.

* **ìì—°ì–´ ì²˜ë¦¬**: í•œêµ­ì–´ íˆ¬ì ì§ˆë¬¸ ìë™ ì´í•´
* **ì˜ë„ ë¶„ì„**: í¬íŠ¸í´ë¦¬ì˜¤/ì¬ë¬´ë¶„ì„/ì‹œì¥ë¶„ì„ ìë™ ë¶„ë¥˜
* **ë§ì¶¤í˜• ì‘ë‹µ**: ì‚¬ìš©ì í”„ë¡œí•„ ê¸°ë°˜ ê°œì¸í™”ëœ íˆ¬ì ì¡°ì–¸

### ğŸ“Š ì§€ëŠ¥í˜• í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”

PyPortfolioOpt ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜í•™ì  ìµœì í™”ì™€ ì‹¤ë¬´ì  ì œì•½ì¡°ê±´ì„ ê²°í•©í•œ 3ê°€ì§€ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™” ì „ëµì„ ì œê³µí•©ë‹ˆë‹¤.

* **Mathematical**: ìƒ¤í”„ë¹„ìœ¨ ìµœëŒ€í™” (ê³ ê¸‰ íˆ¬ìì)
* **Practical**: ì‹¤ìš©ì  ë¶„ì‚°íˆ¬ì (ì¤‘ê¸‰ íˆ¬ìì)
* **Conservative**: ì•ˆì „ ì¤‘ì‹¬ ë¶„ì‚° (ì´ˆë³´ íˆ¬ìì)

### ğŸ’° ì¢…í•© ì¬ë¬´ì œí‘œ ë¶„ì„

DART APIì™€ yfinanceë¥¼ í†µí•´ ìˆ˜ì§‘ëœ ì¬ë¬´ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ AIê°€ ê¸°ì—…ì˜ ì¬ë¬´ ìƒíƒœë¥¼ ë‹¤ê°ë„ë¡œ ë¹„êµ ë¶„ì„í•˜ê³ , ì‹œê°í™” ìë£Œì™€ í•¨ê»˜ íˆ¬ì ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

* **ë™ì  ê¸°ì—…ëª… ë§¤í•‘**: DB ê¸°ë°˜ ì‹¤ì‹œê°„ ê¸°ì—…ëª… ì¸ì‹
* **ë‹¤ì°¨ì› ë¹„êµ**: ë§¤ì¶œ/ì˜ì—…ì´ìµ/ROE ë“± ì£¼ìš” ì§€í‘œ ë¶„ì„
* **íŠ¸ë Œë“œ ë¶„ì„**: ì—°ë„ë³„ ì„±ì¥ì„± ë° ì•ˆì •ì„± í‰ê°€

### ğŸ“ˆ ì‹¤ì‹œê°„ ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘

PyKRX, Yahoo Finance, DART API ë“± ë‹¤ì¤‘ ì†ŒìŠ¤ë¡œë¶€í„° ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê³ , ë°ì´í„° í’ˆì§ˆì„ ì§€ì†ì ìœ¼ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.

* **ë‹¤ì¤‘ ì†ŒìŠ¤ í†µí•©**: PyKRX + Yahoo Finance + DART API
* **ë°°ì¹˜ ì²˜ë¦¬**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì•ˆì •ì  ìˆ˜ì§‘ (100ì¢…ëª©/ë°°ì¹˜)
* **í’ˆì§ˆ ê´€ë¦¬**: ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ ë° ì˜¤ë¥˜ ì²˜ë¦¬
* **ì¦ë¶„ ì—…ë°ì´íŠ¸**: ê¸°ì¡´ ë°ì´í„° ë³´ì¡´í•˜ë©° ì‹ ê·œ ë°ì´í„° ì¶”ê°€

---

## ğŸ› ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
graph TD
    subgraph User Interface
        UI[Streamlit Web App]
    end

    subgraph API Server
        API[FastAPI]
    end

    subgraph AI Engine
        AGENT[AI Agent]
        OPTIMIZER[Portfolio Optimizer]
        LLM[HyperCLOVA X]
    end

    subgraph Data Layer
        DB[(PostgreSQL)]
        ETL[ETL Pipeline]
    end

    subgraph Data Sources
        KRX[PyKRX]
        YF[Yahoo Finance]
        DART[DART API]
    end

    UI --> API
    API --> AGENT
    AGENT --> OPTIMIZER
    AGENT --> LLM
    AGENT --> DB
    OPTIMIZER --> DB
    ETL --> DB
    ETL --> KRX
    ETL --> YF
    ETL --> DART

    ğŸ“ íŒŒì¼ êµ¬ì¡°

    dhtkddn/portfolio-system/
â”œâ”€â”€ airflow/
â”‚   â””â”€â”€ dags/
â”‚       â””â”€â”€ etl_pipeline.py       # Airflow DAGs for ETL automation
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ ai_agent.py           # Main AI agent logic
â”‚   â”‚   â”œâ”€â”€ hyperclova_client.py  # HyperCLOVA X API client
â”‚   â”‚   â”œâ”€â”€ models.py             # Pydantic models for API
â”‚   â”‚   â”œâ”€â”€ news_analysis.py      # News sentiment analysis
â”‚   â”‚   â”œâ”€â”€ portfolio.py          # Basic portfolio creation
â”‚   â”‚   â”œâ”€â”€ portfolio_enhanced.py # Enhanced portfolio with multi-optimization
â”‚   â”‚   â””â”€â”€ stock_database.py     # Stock data management
â”‚   â”œâ”€â”€ schemas.py                # Pydantic schemas for API I/O
â”‚   â””â”€â”€ main.py                   # FastAPI main application
â”œâ”€â”€ db/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ models.py                 # SQLAlchemy DB models
â”œâ”€â”€ etl/
â”‚   â”œâ”€â”€ load_dart.py              # DART financial data ETL
â”‚   â”œâ”€â”€ load_dart_simple.py       # Simplified DART ETL
â”‚   â”œâ”€â”€ load_pykrx.py             # PyKRX stock price ETL
â”‚   â”œâ”€â”€ load_yf.py                # Yahoo Finance data ETL
â”‚   â””â”€â”€ merge_quality.py          # Data merging and quality check
â”œâ”€â”€ optimizer/
â”‚   â””â”€â”€ optimize.py               # Portfolio optimization engine
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ init_db.py                # Database initialization script
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ config.py                 # Configuration settings
â”‚   â””â”€â”€ db.py                     # Database session management
â”œâ”€â”€ .env                          # Environment variables (API keys, DB URL)
â”œâ”€â”€ .gitignore                    # Git ignore file
â”œâ”€â”€ README.md                     # Project documentation
â”œâ”€â”€ requirements.txt              # Python package requirements
â”œâ”€â”€ portfolio_ui.py               # Streamlit UI application
â””â”€â”€ test_*.py                     # Various test scripts

ğŸš€ ì‹œì‘í•˜ê¸°
1. í™˜ê²½ ì„¤ì •

ìš”êµ¬ì‚¬í•­:

Python 3.11+

PostgreSQL

Conda (ê¶Œì¥)

.env íŒŒì¼ ìƒì„±:

í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— .env íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë‚´ìš©ì„ ì±„ì›ë‹ˆë‹¤.

# .env

# Database
DB_URL="postgresql+psycopg2://<user>:<password>@<host>:<port>/<dbname>"

# APIs
DART_API_KEY="<your_dart_api_key>"
NCP_CLOVASTUDIO_API_URL="<your_clova_api_url>"
NCP_CLOVASTUDIO_API_KEY="<your_clova_api_key>"
NCP_CLOVASTUDIO_REQUEST_ID="<your_clova_request_id>"

2. ì„¤ì¹˜

Condaë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ìƒ í™˜ê²½ì„ ìƒì„±í•˜ê³  í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.
conda env create -f environment.yml
conda activate portfolio

3. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”

PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì— í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤.

python scripts/init_db.py

4. ë°ì´í„° ìˆ˜ì§‘ (ETL)

yfinanceë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ì‹ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤. (ì „ì²´ ìˆ˜ì§‘ì€ ëª‡ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)

python etl/load_yf.py

5. API ì„œë²„ ì‹¤í–‰

FastAPI ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

uvicorn app.main:app --host 0.0.0.0 --port 8008 --reload

6. Streamlit UI ì‹¤í–‰

ë³„ë„ì˜ í„°ë¯¸ë„ì—ì„œ Streamlit UIë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

streamlit run portfolio_ui.py

ğŸ§ª í…ŒìŠ¤íŠ¸
í”„ë¡œì íŠ¸ì—ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

API ì‘ë‹µ ì™„ì„±ë„ í…ŒìŠ¤íŠ¸: python test_changes.py

AI ì—ì´ì „íŠ¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸: python examples/test_ai_agent.py

ì¬ë¬´ ë°ì´í„° ì²˜ë¦¬ ê³¼ì • í…ŒìŠ¤íŠ¸: python test_detailed_financial.py

ìˆ˜ì •ì‚¬í•­ ì¢…í•© í…ŒìŠ¤íŠ¸: python test_fixes.py

ê° í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ëŠ” í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
